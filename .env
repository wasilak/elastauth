# elastauth Local Development Configuration
# For testing transparent proxy mode

# ============================================================================
# Core Configuration
# ============================================================================

# Authentication provider
ELASTAUTH_AUTH_PROVIDER=authelia

# Encryption secret key (32 bytes = 64 hex chars)
ELASTAUTH_SECRET_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

# Server configuration
ELASTAUTH_LISTEN=0.0.0.0:8080

# Logging
ELASTAUTH_LOG_LEVEL=debug
ELASTAUTH_LOG_FORMAT=text

# ============================================================================
# Proxy Mode Configuration (ENABLED)
# ============================================================================

# Enable transparent proxy mode
ELASTAUTH_PROXY_ENABLED=true

# Elasticsearch target URL
ELASTAUTH_PROXY_ELASTICSEARCH_URL=http://localhost:9200

# Proxy timeout settings
ELASTAUTH_PROXY_TIMEOUT=30s
ELASTAUTH_PROXY_MAX_IDLE_CONNS=100
ELASTAUTH_PROXY_IDLE_CONN_TIMEOUT=90s

# TLS disabled for local testing
ELASTAUTH_PROXY_TLS_ENABLED=false

# ============================================================================
# Elasticsearch Configuration (for user management)
# ============================================================================

# Note: Elasticsearch hosts must be set in config.yml or as a comma-separated list
# For single host, you can use ELASTAUTH_ELASTICSEARCH_HOSTS_0
ELASTAUTH_ELASTICSEARCH_HOSTS_0=http://localhost:9200
ELASTAUTH_ELASTICSEARCH_USERNAME=elastic
ELASTAUTH_ELASTICSEARCH_PASSWORD=changeme
ELASTAUTH_ELASTICSEARCH_DRY_RUN=false

# ============================================================================
# Cache Configuration
# ============================================================================

# Use Redis cache
ELASTAUTH_CACHE_TYPE=memory
ELASTAUTH_CACHE_EXPIRATION=1h
ELASTAUTH_CACHE_REDIS_HOST=localhost:6379
ELASTAUTH_CACHE_REDIS_DB=0

# ============================================================================
# Authelia Provider Configuration
# ============================================================================

# Header names for Authelia authentication
ELASTAUTH_AUTHELIA_HEADER_USERNAME=Remote-User
ELASTAUTH_AUTHELIA_HEADER_GROUPS=Remote-Groups
ELASTAUTH_AUTHELIA_HEADER_EMAIL=Remote-Email
ELASTAUTH_AUTHELIA_HEADER_NAME=Remote-Name

# ============================================================================
# Role Configuration
# ============================================================================

# Default roles for users without group mappings
# Using 'monitoring_user' for monitoring access and 'kibana_user' for Kibana
# For cluster health monitoring, users need additional privileges
ELASTAUTH_DEFAULT_ROLES=monitoring_user,kibana_user,remote_monitoring_agent

# Group to role mappings
# Map "admin" group to "superuser" role (full Elasticsearch access)
ELASTAUTH_GROUP_MAPPINGS_ADMIN=superuser

# Map "dev" group to kibana_admin and monitoring_user roles
ELASTAUTH_GROUP_MAPPINGS_DEV=kibana_admin,monitoring_user

# ============================================================================
# Monitoring Configuration
# ============================================================================

# Enable Prometheus metrics
ELASTAUTH_ENABLE_METRICS=true

# Disable OpenTelemetry for local testing
ELASTAUTH_ENABLE_OTEL=false
